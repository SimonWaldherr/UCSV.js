/*!*UCSV v1.0.2*Provided under MIT License.**Copyright 2010,Peter Johnson*http://www.uselesscode.org/javascript/csv/*/
"use strict";var CSV=(function(){var f=/^\d+$/,g=/^\d*\.\d+$|^\d+\.\d*$/,i=/^\s|\s$|,|"/,b=(function(){if(String.prototype.trim){return function(j){return j.trim()}}else{return function(j){return j.replace(/^\s*/,"").replace(/\s*$/,"")}}}());function h(j){return Object.prototype.toString.apply(j)==="[object Number]"}function a(j){return Object.prototype.toString.apply(j)==="[object String]"}function d(j){if(j.charAt(j.length-1)!=="\n"){return j}else{return j.substring(0,j.length-1)}}function e(k){var p,m="",o,n,l;for(n=0;n<k.length;n+=1){o=k[n];for(l=0;l<o.length;l+=1){p=o[l];if(a(p)){p=p.replace(/"/g,'""');if(i.test(p)||f.test(p)||g.test(p)){p='"'+p+'"'}else{if(p===""){p='""'}}}else{if(h(p)){p=p.toString(10)}else{if(p===null){p=""}else{p=p.toString()}}}m+=l<o.length-1?p+",":p}m+="\n"}return m}function c(t,p){t=d(t);var q="",l=false,m=false,o="",r=[],j=[],k,n;n=function(s){if(m!==true){if(s===""){s=null}else{if(p===true){s=b(s)}}if(f.test(s)){s=parseInt(s,10)}else{if(g.test(s)){s=parseFloat(s,10)}}}return s};for(k=0;k<t.length;k+=1){q=t.charAt(k);if(l===false&&(q===","||q==="\n")){o=n(o);r.push(o);if(q==="\n"){j.push(r);r=[]}o="";m=false}else{if(q!=='"'){o+=q}else{if(!l){l=true;m=true}else{if(t.charAt(k+1)==='"'){o+='"';k+=1}else{l=false}}}}}o=n(o);r.push(o);j.push(r);return j}return{arrayToCsv:e,csvToArray:c}}());function isString(a){return Object.prototype.toString.apply(a)==="[object String]"}function sanitize_input(a){var b=/^\d+$|^\.\d+$|^\d\.\d*$/;if(isString(a)){if(b.test(a)){a='"'+a+'"'}else{a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;")}}else{if(a===null){a="*null*"}}return a}function addchars(c,d){var b,a="";for(b=0;b<c;b++){a+=d}return a}function csvtotable(){var f,e,g,d="",b="",c=$("#inout").val(),a=CSV.csvToArray(c);for(f=0;f<a.length;f+=1){g=a[f];d+="<tr>";for(e=0;e<g.length;e+=1){b=sanitize_input(g[e]);d+="<td>"+b+"</td>"}d+="</tr>"}$("#grid").html(d)}function tabletocsv(){var d,a,c,e=[],b,f=/^\d+$/,g=/^\d*\.\d+$|^\d+\.\d*$/,h=/^"\d+"$|"\.\d+"$|^"\d+\.\d*"$/,k=$("#grid tr");k.each(function(){var i=[];c=$(this).find("td");c.each(function(){var j=$(this).text();if(f.test(j)){j=parseInt(j,10)}else{if(g.test(j)){j=parseFloat(j,10)}else{if(j==="*null*"){j=null}else{if(h.test(j)){j=j.replace(/"/g,"")}}}}i.push(j)});e.push(i)});b=CSV.arrayToCsv(e);$("#inout").val(b)}function csvtomd(){var f,e,h,d="",b="",c=$("#inout").val(),a=CSV.csvToArray(c);var g=[];for(f=0;f<a.length;f+=1){h=a[f];for(e=0;e<h.length;e+=1){b=sanitize_input(h[e]);if((g[e]<b.length)||(g[e]===undefined)){g[e]=b.length}}}for(f=0;f<a.length;f+=1){h=a[f];d+="";for(e=0;e<h.length;e+=1){b=sanitize_input(h[e])+" ";if(b.length-1<g[e]){b+=addchars((g[e]-b.length+1)," ")}d+=b;if(e!=(h.length-1)){d+="|"}}if(f==0){b="";for(e=0;e<g.length;e+=1){b+=addchars(g[e]+1,"-");if(e!=(g.length-1)){b+="|"}}d+="\n"+b}if(f!=a.length-1){d+="\n"}}$("#markdownta").val(d)}function mdtocsv(){var e=document.getElementById("markdownta").value;var c=e.split("\n");var f=new Array();var a="";var d,b;for(d=0;d<c.length;d+=1){if(d!=1){f=c[d].split("|");for(b=0;b<f.length;b+=1){a+=f[b];if(b!=f.length-1){a+=","}}if(d!=c.lingth-1){a+="\n"}}}document.getElementById("inout").value=a}function addRow(){var b,a=$("#grid tr:last>td").length,c="<tr>";for(b=0;b<a;b+=1){c+="<td>*null*</td>"}c+="</tr>";$("#grid tr:last").after(c)}function addCol(){$("#grid tr").each(function(){$(this).append("<td>*null*</td>")})}$(document).ready(function(){$("#grid td").live("click",function(){var a=prompt("Please enter new value.",$(this).text());$(this).text(a)})});